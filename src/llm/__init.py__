
"""
–ü–∞–∫–µ—Ç llm - —Ä–∞–±–æ—Ç–∞ —Å —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏ –¥–ª—è –±–æ—Ç–∞ –ú–ò–§–ò
–í–∫–ª—é—á–∞–µ—Ç –∞–≥–µ–Ω—Ç–æ–≤, –ø—Ä–æ–º–ø—Ç—ã, RAG —Å–∏—Å—Ç–µ–º—É –∏ –∫–ª–∏–µ–Ω—Ç—ã API
"""

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
from .client import LLMClient, llm_client
from .config import LLM_CONFIG, get_agent_config

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∞–≥–µ–Ω—Ç–æ–≤
try:
    from .agents import (
        ConsultantAgent,
        PsychologistAgent,
        RAGConsultantAgent,
        consultant_agent,
        psychologist_agent,
        rag_consultant_agent
    )
except ImportError:
    # –ï—Å–ª–∏ –∞–≥–µ–Ω—Ç—ã –µ—â–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
    pass

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç—ã
try:
    from .prompts import (
        get_consultant_rag_prompt,
        get_psychologist_prompt_with_history,
        get_welcome_message,
        get_privacy_notice
    )
except ImportError:
    pass

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º RAG —Å–∏—Å—Ç–µ–º—É
try:
    from .rag import VectorStore, SimpleVectorDB
except ImportError:
    pass

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–º—è—Ç—å –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
try:
    from .memory import SessionManager
except ImportError:
    pass

# –í–µ—Ä—Å–∏—è –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç–∞
__version__ = "1.0.0"
__author__ = "–ö–æ–º–∞–Ω–¥–∞ –ú–ò–§–ò"
__description__ = "LLM –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —á–∞—Ç-–±–æ—Ç–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞ –∫–æ–º–µ–Ω–¥–∞–Ω—Ç–∞"

# –°–ø–∏—Å–æ–∫ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –∏–º–µ–Ω
__all__ = [
    # –ö–ª–∏–µ–Ω—Ç—ã
    "LLMClient",
    "llm_client",
    
    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    "LLM_CONFIG",
    "get_agent_config",
    
    # –ê–≥–µ–Ω—Ç—ã
    "ConsultantAgent",
    "PsychologistAgent", 
    "RAGConsultantAgent",
    "consultant_agent",
    "psychologist_agent",
    "rag_consultant_agent",
    
    # –ü—Ä–æ–º–ø—Ç—ã
    "get_consultant_rag_prompt",
    "get_psychologist_prompt_with_history", 
    "get_welcome_message",
    "get_privacy_notice",
    
    # RAG —Å–∏—Å—Ç–µ–º–∞
    "VectorStore",
    "SimpleVectorDB",
    
    # –ü–∞–º—è—Ç—å
    "SessionManager",
]

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –ø–∞–∫–µ—Ç–∞
def init_llm():
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LLM –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"""
    try:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ API –∫–ª—é—á–∞
        from .config import API_KEY, BASE_URL
        
        if not API_KEY:
            print("‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
            print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ YANDEX_CLOUD_API_KEY_1 –≤ .env —Ñ–∞–π–ª–µ")
        
        if not BASE_URL:
            print("‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: BASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
        llm_client.sdk_client  # –ü—Ä–æ—Å—Ç–æ –æ–±—Ä–∞—â–∞–µ–º—Å—è, —á—Ç–æ–±—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
        
        print(f"‚úÖ LLM –ø–∞–∫–µ—Ç v{__version__} –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
        print(f"   –ú–æ–¥–µ–ª—å: {llm_client.model_name}")
        print(f"   –ë–∞–∑–æ–≤—ã–π URL: {llm_client.sdk_client.base_url}")
        
        return True
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ LLM: {e}")
        return False

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –ø–∞–∫–µ—Ç–∞
if __name__ != "__main__":
    init_llm()

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–∞
if __name__ == "__main__":
    print(f"–ü–∞–∫–µ—Ç llm v{__version__}")
    print(__description__)
    print(f"\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:")
    
    for item in __all__:
        print(f"  ‚Ä¢ {item}")
    
    # –¢–µ—Å—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    print("\nüß™ –¢–µ—Å—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:")
    success = init_llm()
    print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {'‚úÖ –£—Å–ø–µ—à–Ω–æ' if success else '‚ùå –û—à–∏–±–∫–∞'}")
    
    # –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    print("\n‚öôÔ∏è  –¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:")
    from .config import LLM_CONFIG
    print(f"–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è LLM –∑–∞–≥—Ä—É–∂–µ–Ω–∞:")
    print(f"  ‚Ä¢ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞: {LLM_CONFIG.get('consultant_agent', {}).get('temperature', 'N/A')}")
    print(f"  ‚Ä¢ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞: {LLM_CONFIG.get('psychologist_agent', {}).get('temperature', 'N/A')}")
    
    print("\n‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!")
